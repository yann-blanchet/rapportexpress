<!DOCTYPE html>
<html>
<head>
  <title>Clear Service Worker</title>
</head>
<body>
  <h1>Service Worker Cleanup</h1>
  <button onclick="clearServiceWorkers()">Clear All Service Workers</button>
  <div id="status"></div>

  <script>
    async function clearServiceWorkers() {
      const status = document.getElementById('status')
      status.innerHTML = '<p>Clearing service workers...</p>'
      
      try {
        if ('serviceWorker' in navigator) {
          const registrations = await navigator.serviceWorker.getRegistrations()
          
          for (let registration of registrations) {
            await registration.unregister()
            console.log('Unregistered:', registration.scope)
          }
          
          // Clear all caches
          const cacheNames = await caches.keys()
          for (let cacheName of cacheNames) {
            await caches.delete(cacheName)
            console.log('Deleted cache:', cacheName)
          }
          
          status.innerHTML = `<p style="color: green;">âœ… Cleared ${registrations.length} service worker(s) and ${cacheNames.length} cache(s)</p>`
          status.innerHTML += '<p>Now close this tab and restart your dev server.</p>'
        } else {
          status.innerHTML = '<p style="color: orange;">No service workers found.</p>'
        }
      } catch (error) {
        status.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`
      }
    }
    
    // Auto-run on load
    window.addEventListener('load', () => {
      setTimeout(clearServiceWorkers, 500)
    })
  </script>
</body>
</html>
